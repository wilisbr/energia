(function(){"use strict";var e={6691:function(e,t,o){var n=o(9242),a=o(3396),s=o(7139);const i={id:"wrapper"},r={class:"navbar is-success"},l={class:"navbar-brand"},u=(0,a._)("strong",null," C.W. Gestão de Energia Fotovoltaica",-1),c=(0,a._)("span",{"aria-hidden":"true"},null,-1),d=(0,a._)("span",{"aria-hidden":"true"},null,-1),m=(0,a._)("span",{"aria-hidden":"true"},null,-1),p=[c,d,m],h={class:"navbar-end"},g={class:"navbar-item"},_={class:"buttons"},f=(0,a.Uk)("Instalações"),v=(0,a.Uk)("Faturas"),w=(0,a.Uk)("Meu Perfil"),b=(0,a.Uk)("Log in"),y={class:"section"},k=(0,a._)("footer",{class:"footer"},[(0,a._)("p",{class:"has-text-centered"},"Copyright (c) 2021")],-1);function U(e,t,o,c,d,m){const U=(0,a.up)("router-link"),C=(0,a.up)("router-view");return(0,a.wg)(),(0,a.iD)("div",i,[(0,a._)("nav",r,[(0,a._)("div",l,[(0,a.Wm)(U,{to:"/",class:"navbar-item"},{default:(0,a.w5)((()=>[u])),_:1}),(0,a._)("a",{class:"navbar-burger","aria-label":"menu","aria-expanded":"false","data-target":"navbar-menu",onClick:t[0]||(t[0]=e=>d.showMobileMenu=!d.showMobileMenu)},p)]),(0,a._)("div",h,[(0,a._)("div",{class:(0,s.C_)(["navbar-menu",{"is-active":d.showMobileMenu}]),id:"navbar-menu"},[(0,a._)("div",g,[(0,a._)("div",_,[""!=e.$store.state.access?((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[(0,a.Wm)(U,{to:"/clientes",class:"navbar-item"},{default:(0,a.w5)((()=>[f])),_:1}),(0,a.Wm)(U,{to:"/faturas",class:"navbar-item"},{default:(0,a.w5)((()=>[v])),_:1}),(0,a.Wm)(U,{to:"/my-account",class:"navbar-item"},{default:(0,a.w5)((()=>[w])),_:1})],64)):((0,a.wg)(),(0,a.j4)(U,{key:1,to:"/log-in",class:"button is-light"},{default:(0,a.w5)((()=>[b])),_:1}))])])],2)])]),(0,a.wy)((0,a._)("progress",null,null,512),[[n.F8,e.$store.state.isLoading]]),(0,a._)("section",y,[(0,a.Wm)(C)]),k])}var C=o(6265),$=o.n(C),x={name:"App",data(){return{showMobileMenu:!1}},mounted(){},beforeCreate(){this.$store.commit("initializeStore");const e=this.$store.state.access;$().defaults.headers.common.Authorization=e?"JWT "+e:"",console.log($().defaults.headers.common.Authorization),document.title="Gestão Energia"}},D=o(89);const F=(0,D.Z)(x,[["render",U]]);var I=F,L=o(678);const O={class:"container"},z=(0,a.uE)('<div class="content is-normal has-text-justified"><p> Este sistema possbilita uma gestão <strong>eficiente</strong> para quem possui sistema de geração distribuída e trasfere o excedente para outras instalações, recebendo, em contrapartida, uma compensação financeira. O objetivo do sistema é automatizar todo o cálculo e a geração da cobrança para o seu cliente. O sistema torna tudo muito simples e rápido, de modo que você configura poucos parâmetros e faz o upload da conta de luz no formato PDF (o arquivo deverá ser baixado do site da CEMIG). Com poucos segundos você terá em mãos um documento explicando ao seu cliente o quanto ele economizou e quanto dele deverá te pagar.</p> Caso você precise fazer uma gestão completa, incluindo prospecção de clientes, relacionamento e cobrança, entre em contato para firmarmos uma paceria <strong>(gestao_fotovoltaica@aol.com).</strong> Caso você opter por fazer todo o trabalho, sinta-se livre para utilizar este sistema de forma <strong>gratuita!</strong><h2> Instruções de uso </h2><h3>1) Cadastrando as Instalações</h3><p> No menu superior, acesse a opção &quot;Instalações&quot; e cadastre cada instalação, preenchendo os campos cadastrais.</p><p>Uma das oções é o <strong>desconto</strong>, onde o usuário irá definir qual o percentual de desconto, em relação ao preço da concessionária. Ex: se a concessionária cobra R$ 1,00 por kwh, o usuário que definir 20% de desconto, estará cobrando R$ 0,80 centavos do cliente, por KWh.</p><p> Outra opção importante é o <strong> bônus </strong>, que corresponde a um desconto absoluto e incondicional que será aplicado no faturamento do seu cliente. Recomendamos deixar o campo com valor 0, inicialmente</p><h3>2) Fazendo upload das contas </h3><p> Após incluir a instalação do seu cliente, acesso a opção <strong>Faturas</strong> no menu superior, escolha a instalação desejada e faça o upload da fatura. Importante ressaltar que o sistema só vai reconhecer faturas baixadas <strong>diretamente do site da Cemig</strong>, no formato PDF. Estamos trabalhando para adicionar outras concessionárias. A próxima a ser incluída será a Enel</p><h3>3) Geração da cobrança</h3><p>Escolha uma das faturas que foram incluídas e clique na opção <strong>Faturar</strong>. Faça o download e envie para seu cliente!</p></div>',1),q=[z];function V(e,t,o,n,s,i){return(0,a.wg)(),(0,a.iD)("div",O,q)}var T={name:"HomeView",data(){return{user_data:""}},components:{},mounted(){},methods:{getMe(e){console.log($().defaults.headers.common.Authorization),$().get("/api/v1/users/me").then((e=>{console.log(e),this.user_data=e.data.username})).catch((e=>{console.log(e)}))}}};const P=(0,D.Z)(T,[["render",V]]);var S=P;const N={class:"sign-up-page"},M=(0,a._)("h1",null," Sign up ",-1),A=(0,a._)("label",null,"Username:",-1),H=(0,a.Uk)(),j=(0,a._)("br",null,null,-1),R=(0,a._)("br",null,null,-1),E=(0,a._)("label",null,"Password:",-1),W=(0,a.Uk)(),K=(0,a._)("br",null,null,-1),J=(0,a._)("br",null,null,-1),Y=(0,a._)("label",null,"Password 2:",-1),Z=(0,a.Uk)(),G=(0,a._)("br",null,null,-1),B=(0,a._)("br",null,null,-1),Q={key:0,class:"notification is-danger"},X=(0,a._)("button",{type:"submit"}," Sign up",-1);function ee(e,t,o,i,r,l){return(0,a.wg)(),(0,a.iD)("div",N,[M,(0,a._)("form",{onSubmit:t[3]||(t[3]=(0,n.iM)(((...e)=>l.submitForm&&l.submitForm(...e)),["prevent"]))},[A,(0,a.wy)((0,a._)("input",{type:"email",name:"username","onUpdate:modelValue":t[0]||(t[0]=e=>r.username=e)},null,512),[[n.nr,r.username]]),H,j,R,E,(0,a.wy)((0,a._)("input",{type:"password",name:"password","onUpdate:modelValue":t[1]||(t[1]=e=>r.password=e)},null,512),[[n.nr,r.password]]),W,K,J,Y,(0,a.wy)((0,a._)("input",{type:"password",name:"password2","onUpdate:modelValue":t[2]||(t[2]=e=>r.password2=e)},null,512),[[n.nr,r.password2]]),Z,G,B,r.errors.length?((0,a.wg)(),(0,a.iD)("div",Q,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.errors,(e=>((0,a.wg)(),(0,a.iD)("p",{key:e},(0,s.zw)(e),1)))),128))])):(0,a.kq)("",!0),X],32)])}var te=o(5597),oe={name:"SignUp",data(){return{username:"",password:"",password2:"",errors:[]}},methods:{submitForm(e){if(this.errors=[],""===this.username&&this.errors.push("The username is missing"),""===this.password&&this.errors.push("The password is too short"),this.password!==this.password2&&this.errors.push("The passwords doesn't match"),!this.errors.length){const e={username:this.username,password:this.password};$().post("/api/v1/users/",e).then((e=>{(0,te.toast)({message:"Account created, please log in!",type:"is-success",dismissible:!0,pauseOnHover:!0,duration:2e3,position:"bottom-right"}),this.$router.push("/log-in")})).catch((e=>{if(e.response){for(const t in e.response.data)this.errors.push(`${t}: ${e.response.data[t]}`);console.log(JSON.stringify(e.response.data))}else e.message&&(this.errors.push("Something went wrong. Please try again"),console.log(JSON.stringify(e)))}))}}}};const ne=(0,D.Z)(oe,[["render",ee]]);var ae=ne;const se={class:"log-in-page"},ie=(0,a._)("h1",null," Log In ",-1),re=(0,a._)("label",null,"Username:",-1),le=(0,a.Uk)(),ue=(0,a._)("br",null,null,-1),ce=(0,a._)("br",null,null,-1),de=(0,a._)("label",null,"Password:",-1),me=(0,a.Uk)(),pe=(0,a._)("br",null,null,-1),he=(0,a._)("br",null,null,-1),ge={key:0,class:"notification is-danger"},_e=(0,a._)("button",{type:"submit"},"Log in",-1),fe=(0,a._)("a",{href:"http://127.0.0.1:8000/accounts/password_reset/"}," Esqueci minha senha ",-1),ve=(0,a.Uk)(" Ou "),we=(0,a.Uk)("Clique aqui"),be=(0,a.Uk)(" para se cadastrar! ");function ye(e,t,o,i,r,l){const u=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)("div",se,[ie,(0,a._)("form",{onSubmit:t[2]||(t[2]=(0,n.iM)(((...e)=>l.submitForm&&l.submitForm(...e)),["prevent"]))},[re,(0,a.wy)((0,a._)("input",{type:"email",name:"username","onUpdate:modelValue":t[0]||(t[0]=e=>r.username=e)},null,512),[[n.nr,r.username]]),le,ue,ce,de,(0,a.wy)((0,a._)("input",{type:"password",name:"password","onUpdate:modelValue":t[1]||(t[1]=e=>r.password=e)},null,512),[[n.nr,r.password]]),me,pe,he,r.errors.length?((0,a.wg)(),(0,a.iD)("div",ge,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.errors,(e=>((0,a.wg)(),(0,a.iD)("p",{key:e},(0,s.zw)(e),1)))),128))])):(0,a.kq)("",!0),_e,fe,ve,(0,a.Wm)(u,{to:"/sign-up"},{default:(0,a.w5)((()=>[we])),_:1}),be],32)])}var ke={name:"LogIn",data(){return{username:"",password:"",errors:[]}},methods:{submitForm(e){$().defaults.headers.common.Authorization="",localStorage.removeItem("access");const t={username:this.username,password:this.password};$().post("/api/v1/jwt/create/",t).then((e=>{console.log("Deu certo!"),console.log(e);const t=e.data.access;this.$store.commit("setAccess",t),$().defaults.headers.common.Authorization="JWT "+t,localStorage.setItem("access",t),this.$router.push("/")})).catch((e=>{if(e.response)for(const t in e.response.data)this.errors.push(`${t}: ${e.response.data[t]}`);else this.errors.push("Something went wrong. Please try again"),console.log(JSON.stringify(e))}))}}};const Ue=(0,D.Z)(ke,[["render",ye]]);var Ce=Ue;const $e={class:"page-my-account"},xe={class:"columns is-multiline"},De={class:"column is-12"},Fe=["src"],Ie={class:"column is-12"},Le=(0,a._)("hr",null,null,-1);function Oe(e,t,o,n,i,r){return(0,a.wg)(),(0,a.iD)("div",$e,[(0,a._)("div",xe,[(0,a._)("div",De,[(0,a._)("span",{src:i.user_data},(0,s.zw)(i.user_data),9,Fe)]),(0,a._)("div",Ie,[(0,a._)("button",{onClick:t[0]||(t[0]=e=>r.logout()),class:"button is-danger"},"Log out")]),Le])])}var ze={name:"MyAccount",components:{},data(){return{user_data:""}},mounted(){this.getMe()},methods:{logout(){$().defaults.headers.common.Authorization="",localStorage.removeItem("access"),this.$store.commit("removeToken"),this.$router.push("/")},async getMe(e){this.$store.commit("setIsLoading",!0),console.log($().defaults.headers.common.Authorization),await $().get("/api/v1/users/me").then((e=>{console.log(e),this.user_data=e.data.username})).catch((e=>{console.log(e)})),this.$store.commit("setIsLoading",!1)}}};const qe=(0,D.Z)(ze,[["render",Oe]]);var Ve=qe;const Te={class:"page-cart"},Pe={class:"columns is-multiline"},Se=(0,a._)("div",{class:"column is-12"},[(0,a._)("h1",{class:"title"},"Faturas")],-1),Ne={key:0,class:"notification is-danger"},Me={class:"column is-12 box"},Ae=(0,a._)("label",null,"Instalação cliente",-1),He=["value"],je=(0,a._)("br",null,null,-1),Re=(0,a._)("br",null,null,-1),Ee=(0,a._)("button",{type:"submit"},"Inserir Fatura",-1),We=(0,a._)("br",null,null,-1),Ke=(0,a._)("hr",null,null,-1),Je={key:0,class:"table is-fullwidth"},Ye=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"Instalação"),(0,a._)("th",null,"Mês de Referência"),(0,a._)("th",null,"Ação")])],-1),Ze=["onClick"],Ge=["onClick"],Be={key:1};function Qe(e,t,o,i,r,l){return(0,a.wg)(),(0,a.iD)("div",Te,[(0,a._)("div",Pe,[Se,r.errors.length?((0,a.wg)(),(0,a.iD)("div",Ne,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.errors,(e=>((0,a.wg)(),(0,a.iD)("p",{key:e},(0,s.zw)(e),1)))),128))])):(0,a.kq)("",!0),(0,a._)("div",Me,[(0,a._)("form",{onSubmit:t[2]||(t[2]=(0,n.iM)(((...e)=>l.nova_fatura&&l.nova_fatura(...e)),["prevent"]))},[Ae,(0,a.wy)((0,a._)("select",{required:"","onUpdate:modelValue":t[0]||(t[0]=e=>r.id_cliente=e)},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.clientes,(e=>((0,a.wg)(),(0,a.iD)("option",{value:e.id,key:e.id},(0,s.zw)(e.nome),9,He)))),128))],512),[[n.bM,r.id_cliente]]),je,Re,(0,a._)("input",{required:"",type:"file",id:"nova_fatura",name:"nova_fatura",accept:".pdf",onChange:t[1]||(t[1]=(...e)=>l.onFileChange&&l.onFileChange(...e))},null,32),Ee],32),We,Ke,r.faturas.length>0?((0,a.wg)(),(0,a.iD)("table",Je,[Ye,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.faturas,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("td",null,(0,s.zw)(t.nome_cliente),1),(0,a._)("td",null,(0,s.zw)(t.referencia),1),(0,a._)("td",null,[(0,a._)("button",{onClick:o=>e.$router.push("/fatura/"+t.id)},"Faturar",8,Ze),(0,a._)("button",{onClick:e=>l.apagar(t)},"Remover",8,Ge)])])))),128))])])):((0,a.wg)(),(0,a.iD)("p",Be,"Não foram encontradas faturas..."))])])])}var Xe={name:"Faturas",data(){return{faturas:[],clientes:[],errors:[],fatura:Object,id_cliente:-1,conta_pdf:Object}},components:{},mounted(){this.$store.commit("setIsLoading",!0),this.getFaturamentos(),this.getClientes(),this.$store.commit("setIsLoading",!1)},methods:{logout(){(0,te.toast)({message:"Ticket expirado. Faça novo login",type:"is-success",dismissible:!0,pauseOnHover:!0,duration:2e3,position:"bottom-right"}),$().defaults.headers.common.Authorization="",localStorage.removeItem("access"),this.$store.commit("removeToken"),this.$router.push("/log-in")},async getClientes(){await new Promise((e=>setTimeout(e,1e3))),await $().get("/api/v1/clientes/").then((e=>{this.clientes=e.data,console.log(e)})).catch((e=>{401===e.response.status&&(console.log("Ticket expirado. Necessário novo login"),this.logout()),console.log(e)}))},onFileChange(e){var t=e.target.files||e.dataTransfer.files;t.length&&(this.conta_pdf=t[0])},upload_fatura:async function(e){let t=new FormData;this.conta_pdf&&t.append("conta_pdf",this.conta_pdf),$().defaults.headers.put["Content-Type"]="application/json",await $().put(`/api/v1/faturamentos/${this.fatura.id}/`,t).then((e=>{this.fatura=e.data})).catch((e=>{if(e.response)for(const t in e.response.data)this.errors.push(`${t}: ${e.response.data[t]}`);else this.errors.push("Something went wrong. Please try again"),console.log(JSON.stringify(e))})),await this.carregarConta()},carregarConta:async function(e){console.log(this.fatura);let t=new FormData;t.append("id",this.fatura.id),await $().post("/api/v1/carregarConta",t).then((e=>{this.fatura=e.data})).catch((e=>{if(e.response)for(const t in e.response.data)this.errors.push(`${t}: ${e.response.data[t]}`);else this.errors.push("Something went wrong. Please try again"),console.log(JSON.stringify(e))}))},async nova_fatura(){console.log(this.errors.length),this.errors.length||(this.$store.commit("setIsLoading",!0),this.fatura={cpf_cliente:this.id_cliente},await $().post("/api/v1/faturamentos/",this.fatura).then((e=>{this.fatura=e.data})).catch((e=>{401===e.response.status&&(console.log("Ticket expirado. Necessário novo login"),this.logout()),console.log(e)})),await this.upload_fatura(),await this.getFaturamentos(),this.$store.commit("setIsLoading",!1))},async apagar(e){this.$store.commit("setIsLoading",!0),await $()["delete"]("/api/v1/faturamentos/"+e.id+"/").then((e=>{this.getFaturamentos()})).catch((e=>{401===e.response.status&&(console.log("Ticket expirado. Necessário novo login"),this.logout()),console.log(e)})),this.$store.commit("setIsLoading",!1)},async getFaturamentos(){await $().get("/api/v1/faturamentos/").then((e=>{this.faturas=e.data,console.log(e)})).catch((e=>{401===e.response.status&&(console.log("Ticket expirado. Necessário novo login"),this.logout()),console.log(e)}));for(let e=0;e<this.faturas.length;e+=1)await $().get("/api/v1/clientes/"+this.faturas[e].cpf_cliente+"/").then((t=>{this.faturas[e].nome_cliente=t.data.nome})).catch((e=>{console.log("Cliente não encontrado")}))}}};const et=(0,D.Z)(Xe,[["render",Qe]]);var tt=et;const ot=e=>((0,a.dD)("data-v-2b5c05c5"),e=e(),(0,a.Cn)(),e),nt={class:"page-cart"},at=["href"],st=ot((()=>(0,a._)("br",null,null,-1))),it={className:"padding-table-columns"},rt=ot((()=>(0,a._)("label",null,"Percentual de desconto sob o KWh:",-1))),lt=(0,a.Uk)(" %"),ut=ot((()=>(0,a._)("label",null,"Bônus adicional (R$):",-1))),ct=ot((()=>(0,a._)("br",null,null,-1))),dt=ot((()=>(0,a._)("br",null,null,-1))),mt=ot((()=>(0,a._)("button",{type:"submit"},"Gravar",-1))),pt=(0,a.Uk)(" ou "),ht=(0,a.Uk)("Voltar"),gt=["src"];function _t(e,t,o,i,r,l){const u=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)("div",nt,[(0,a._)("a",{href:r.fatura.conta_pdf,target:"_blank"},"Clique para ver fatura da concessionária",8,at),st,(0,a._)("form",{onSubmit:t[2]||(t[2]=(0,n.iM)(((...e)=>l.gravar&&l.gravar(...e)),["prevent"]))},[(0,a._)("table",it,[(0,a._)("tr",null,[(0,a._)("td",null,[rt,(0,a.wy)((0,a._)("input",{required:"",type:"number",min:"0",max:"100",step:"1","onUpdate:modelValue":t[0]||(t[0]=e=>r.fatura.desconto=e)},null,512),[[n.nr,r.fatura.desconto]]),lt]),(0,a._)("td",null,[ut,(0,a.wy)((0,a._)("input",{required:"","onUpdate:modelValue":t[1]||(t[1]=e=>r.fatura.bonus=e),type:"number",min:"0",step:"0.01"},null,512),[[n.nr,r.fatura.bonus]]),ct,dt]),(0,a._)("td",null,[mt,pt,(0,a.Wm)(u,{to:"/faturas"},{default:(0,a.w5)((()=>[ht])),_:1})])])])],32),((0,a.wg)(),(0,a.iD)("iframe",{key:r.id_iFrameCobrancaPDF,src:`${r.baseURL}/api/v1/getFaturaPdf?id=${r.id}`,width:"100%",height:"700px"},null,8,gt)),(0,a._)("p",null,(0,s.zw)(r.baseURL),1)])}o(7008);var ft={name:"Fatura",data(){return{id:this.$route.params.id,fatura:Object,conta_pdf:Object,id_iFrameCobrancaPDF:Number,baseURL:String}},components:{},props:{},mounted(){this.id_iFrameCobrancaPDF=0,this.getFatura(),this.baseURL=$().defaults.baseURL},methods:{async getFatura(){await $().get("/api/v1/faturamentos/"+this.id+"/").then((e=>{this.fatura=e.data,console.log(e)})).catch((e=>{console.log(e)}))},carregarConta:async function(e){let t=new FormData;t.append("id",this.fatura.id),await $().post("/api/v1/carregarConta",t).then((e=>{this.fatura=e.data})).catch((e=>{if(e.response)for(const t in e.response.data)this.errors.push(`${t}: ${e.response.data[t]}`);else this.errors.push("Something went wrong. Please try again"),console.log(JSON.stringify(e))}))},gravar:async function(e){delete this.fatura.conta_pdf,await $().put(`/api/v1/faturamentos/${this.id}/`,this.fatura).then((e=>{console.log("Deu certo!"),console.log(e),this.fatura=e.data})).catch((e=>{if(e.response)for(const t in e.response.data)this.errors.push(`${t}: ${e.response.data[t]}`);else this.errors.push("Something went wrong. Please try again"),console.log(JSON.stringify(e))})),await this.carregarConta(),this.id_iFrameCobrancaPDF=this.id_iFrameCobrancaPDF+1}}};const vt=(0,D.Z)(ft,[["render",_t],["__scopeId","data-v-2b5c05c5"]]);var wt=vt;const bt=e=>((0,a.dD)("data-v-817fbd7c"),e=e(),(0,a.Cn)(),e),yt={class:"container"},kt={class:"columns is-multiline"},Ut=bt((()=>(0,a._)("h1",{class:"title"},"Instalações clientes",-1))),Ct={key:0,class:"notification is-danger"},$t={class:"table"},xt=bt((()=>(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"CPF do Cliente"),(0,a._)("th",null,"Nome da instalação"),(0,a._)("th",null,"Endereço da Instalação"),(0,a._)("th",null,"E-mail"),(0,a._)("th",null,"Telefone"),(0,a._)("th",null,"Desconto"),(0,a._)("th",null,"Bônus"),(0,a._)("th")])],-1))),Dt=["onUpdate:modelValue"],Ft=["onUpdate:modelValue"],It=["onUpdate:modelValue"],Lt=["onUpdate:modelValue"],Ot=["onUpdate:modelValue"],zt=["onUpdate:modelValue"],qt=(0,a.Uk)("%"),Vt=(0,a.Uk)(" R$ "),Tt=["onUpdate:modelValue"],Pt=["onClick"],St=["onClick"],Nt=["onClick"],Mt=(0,a.Uk)("%"),At=(0,a.Uk)("R$");function Ht(e,t,o,i,r,l){return(0,a.wg)(),(0,a.iD)("div",yt,[(0,a._)("div",kt,[Ut,r.errors.length?((0,a.wg)(),(0,a.iD)("div",Ct,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.errors,(e=>((0,a.wg)(),(0,a.iD)("p",{key:e},(0,s.zw)(e),1)))),128))])):(0,a.kq)("",!0),(0,a._)("table",$t,[xt,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.clientes,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":e=>t.cpf_cliente=e,type:"number",max:"99999999999",style:{width:"11em"},size:"11"},null,8,Dt),[[n.nr,t.cpf_cliente]])]),(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":e=>t.nome=e,type:"text",max:"40"},null,8,Ft),[[n.nr,t.nome]])]),(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":e=>t.endereco=e,type:"text",max:"84"},null,8,It),[[n.nr,t.endereco]])]),(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":e=>t.email=e,type:"email"},null,8,Lt),[[n.nr,t.email]])]),(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":e=>t.telefone=e,type:"text",size:"13",max:"15"},null,8,Ot),[[n.nr,t.telefone]])]),(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":e=>t.desconto=e,type:"number",min:"0",max:"100",step:"1",size:"3"},null,8,zt),[[n.nr,t.desconto]]),qt]),(0,a._)("td",null,[Vt,(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":e=>t.bonus=e,type:"number",min:"0",step:"0.01"},null,8,Tt),[[n.nr,t.bonus]])]),(0,a._)("td",null,[(0,a._)("button",{onClick:e=>l.gravar(t)},"Gravar",8,Pt),(0,a._)("button",{onClick:e=>l.apagar(t)},"Remover",8,St),(0,a._)("button",{onClick:o=>e.$router.push("/cliente/"+t.id)},"Editar",8,Nt)])])))),128)),(0,a._)("tr",null,[(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.novo_cliente.cpf_cliente=e),type:"number",max:"99999999999",style:{width:"11em"},size:"11"},null,512),[[n.nr,r.novo_cliente.cpf_cliente]])]),(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.novo_cliente.nome=e),type:"text",max:"40"},null,512),[[n.nr,r.novo_cliente.nome]])]),(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.novo_cliente.endereco=e),type:"text",max:"84"},null,512),[[n.nr,r.novo_cliente.endereco]])]),(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>r.novo_cliente.email=e),type:"email"},null,512),[[n.nr,r.novo_cliente.email]])]),(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>r.novo_cliente.telefone=e),type:"text",size:"13",max:"15"},null,512),[[n.nr,r.novo_cliente.telefone]])]),(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>r.novo_cliente.desconto=e),type:"number",min:"0",max:"100",step:"1",size:"3"},null,512),[[n.nr,r.novo_cliente.desconto]]),Mt]),(0,a._)("td",null,[At,(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>r.novo_cliente.bonus=e),type:"number",min:"0",step:"0.01"},null,512),[[n.nr,r.novo_cliente.bonus]])]),(0,a._)("td",null,[(0,a._)("button",{onClick:t[7]||(t[7]=e=>l.novo(r.novo_cliente))},"Incluir")])])])])])])}var jt={name:"Clientes",data(){return{clientes:[],cliente:Object,errors:[],novo_cliente:{cpf_cliente:Number,nome:"",telefone:"",endereco:"",email:"",desconto:20,bonus:0}}},components:{},mounted(){this.getClientes()},methods:{logout(){(0,te.toast)({message:"Ticket expirado. Faça novo login",type:"is-success",dismissible:!0,pauseOnHover:!0,duration:2e3,position:"bottom-right"}),$().defaults.headers.common.Authorization="",localStorage.removeItem("access"),this.$store.commit("removeToken"),this.$router.push("/log-in")},async validar_campos(e){if(this.errors=[],0==/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e.email))return this.errors.push("Preencha o e-mail corretamente"),null;""==e.nome&&this.errors.push("Preencha o nome da instalação"),(e.desconto<0||e.desconto>100||""==e.desconto)&&this.errors.push("O valor de desconto deve ser entre 0% e 100%"),(e.bonus<0||""==e.bonus)&&this.errors.push("O valor do bônus deve ser preenchido com 0 ou qualquer número positivo")},async gravar(e){this.validar_campos(e),this.errors.length||(this.$store.commit("setIsLoading",!0),console.log(e),await $().put("/api/v1/clientes/"+e.id+"/",e).then((e=>{(0,te.toast)({message:"Cliente alterado",type:"is-success",dismissible:!0,pauseOnHover:!0,duration:2e3,position:"bottom-right"}),this.getClientes()})).catch((e=>{401===e.response.status&&(console.log("Ticket expirado. Necessário novo login"),this.logout()),console.log(e)})),this.$store.commit("setIsLoading",!1))},async apagar(e){this.$store.commit("setIsLoading",!0),console.log(e),await $()["delete"]("/api/v1/clientes/"+e.id+"/",e).then((e=>{(0,te.toast)({message:"Cliente removido da base de dados",type:"is-success",dismissible:!0,pauseOnHover:!0,duration:2e3,position:"bottom-right"}),this.getClientes()})).catch((e=>{401===e.response.status&&(console.log("Ticket expirado. Necessário novo login"),this.logout()),console.log(e)})),await new Promise((e=>setTimeout(e,3e3))),this.$store.commit("setIsLoading",!1)},async novo(e){await this.validar_campos(e),this.errors.length||(this.$store.commit("setIsLoading",!0),console.log(e),await $().post("/api/v1/clientes/",e).then((e=>{(0,te.toast)({message:"Cliente adicionado",type:"is-success",dismissible:!0,pauseOnHover:!0,duration:2e3,position:"bottom-right"}),this.getClientes()})).catch((e=>{401===e.response.status&&(console.log("Ticket expirado. Necessário novo login"),this.logout()),console.log(e)})),await new Promise((e=>setTimeout(e,3e3))),this.$store.commit("setIsLoading",!1))},async getClientes(){this.$store.commit("setIsLoading",!0),await $().get("/api/v1/clientes/").then((e=>{this.clientes=e.data,console.log(e)})).catch((e=>{401===e.response.status&&(console.log("Ticket expirado. Necessário novo login"),this.logout()),console.log(e)})),this.$store.commit("setIsLoading",!1)}}};const Rt=(0,D.Z)(jt,[["render",Ht],["__scopeId","data-v-817fbd7c"]]);var Et=Rt;const Wt=e=>((0,a.dD)("data-v-65076a6f"),e=e(),(0,a.Cn)(),e),Kt={class:"container"},Jt={key:0,class:"notification is-danger"},Yt={class:"table"},Zt=Wt((()=>(0,a._)("td",null,"CPF do Cliente",-1))),Gt=(0,a.Uk)(),Bt=Wt((()=>(0,a._)("td",null,"Nome da Instalação",-1))),Qt=(0,a.Uk)(),Xt=Wt((()=>(0,a._)("td",null,"Endereço",-1))),eo=(0,a.Uk)(),to=Wt((()=>(0,a._)("td",null,"E-mail",-1))),oo=(0,a.Uk)(),no=Wt((()=>(0,a._)("td",null,"Telefone",-1))),ao=(0,a.Uk)(),so=Wt((()=>(0,a._)("td",null,"Desconto",-1))),io=(0,a.Uk)(),ro=(0,a.Uk)("%"),lo=Wt((()=>(0,a._)("td",null,"Bônus",-1))),uo=(0,a.Uk)(),co=(0,a.Uk)(" R$ ");function mo(e,t,o,i,r,l){return(0,a.wg)(),(0,a.iD)("div",Kt,[r.errors.length?((0,a.wg)(),(0,a.iD)("div",Jt,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.errors,(e=>((0,a.wg)(),(0,a.iD)("p",{key:e},(0,s.zw)(e),1)))),128))])):(0,a.kq)("",!0),(0,a._)("table",Yt,[(0,a._)("tbody",null,[(0,a._)("tr",null,[Zt,Gt,(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.cliente.cpf_cliente=e),type:"number",max:"99999999999",style:{width:"11em"},size:"11"},null,512),[[n.nr,r.cliente.cpf_cliente]])])]),(0,a._)("tr",null,[Bt,Qt,(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.cliente.nome=e),type:"text",max:"40"},null,512),[[n.nr,r.cliente.nome]])])]),(0,a._)("tr",null,[Xt,eo,(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.cliente.endereco=e),type:"text",max:"84"},null,512),[[n.nr,r.cliente.endereco]])])]),(0,a._)("tr",null,[to,oo,(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>r.cliente.email=e),type:"email"},null,512),[[n.nr,r.cliente.email]])])]),(0,a._)("tr",null,[no,ao,(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>r.cliente.telefone=e),type:"text",size:"13",max:"15"},null,512),[[n.nr,r.cliente.telefone]])])]),(0,a._)("tr",null,[so,io,(0,a._)("td",null,[(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>r.cliente.desconto=e),type:"number",min:"0",max:"100",step:"1",size:"3"},null,512),[[n.nr,r.cliente.desconto]]),ro])]),(0,a._)("tr",null,[lo,uo,(0,a._)("td",null,[co,(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>r.cliente.bonus=e),type:"number",min:"0",step:"0.01"},null,512),[[n.nr,r.cliente.bonus]])])])])]),(0,a._)("button",{onClick:t[7]||(t[7]=e=>l.gravar(r.cliente))},"Gravar")])}var po={name:"Clientes",data(){return{cliente:Object,errors:[],novo_cliente:{cpf_cliente:Number,nome:"",telefone:"",endereco:"",email:"",desconto:20,bonus:0}}},components:{},mounted(){},methods:{logout(){(0,te.toast)({message:"Ticket expirado. Faça novo login",type:"is-success",dismissible:!0,pauseOnHover:!0,duration:2e3,position:"bottom-right"}),$().defaults.headers.common.Authorization="",localStorage.removeItem("access"),this.$store.commit("removeToken"),this.$router.push("/log-in")},async validar_campos(e){if(this.errors=[],0==/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e.email))return this.errors.push("Preencha o e-mail corretamente"),null;""==e.nome&&this.errors.push("Preencha o nome da instalação"),(e.desconto<0||e.desconto>100||""==e.desconto)&&this.errors.push("O valor de desconto deve ser entre 0% e 100%"),(e.bonus<0||""==e.bonus)&&this.errors.push("O valor do bônus deve ser preenchido com 0 ou qualquer número positivo")},async gravar(e){this.validar_campos(e),this.errors.length||(this.$store.commit("setIsLoading",!0),console.log(e),await $().put("/api/v1/clientes/"+e.id+"/",e).then((e=>{(0,te.toast)({message:"Cliente alterado",type:"is-success",dismissible:!0,pauseOnHover:!0,duration:2e3,position:"bottom-right"}),this.getClientes()})).catch((e=>{401===e.response.status&&(console.log("Ticket expirado. Necessário novo login"),this.logout()),console.log(e)})),this.$store.commit("setIsLoading",!1))},async novo(e){await this.validar_campos(e),this.errors.length||(this.$store.commit("setIsLoading",!0),console.log(e),await $().post("/api/v1/clientes/",e).then((e=>{(0,te.toast)({message:"Cliente adicionado",type:"is-success",dismissible:!0,pauseOnHover:!0,duration:2e3,position:"bottom-right"}),this.getClientes()})).catch((e=>{401===e.response.status&&(console.log("Ticket expirado. Necessário novo login"),this.logout()),console.log(e)})),await new Promise((e=>setTimeout(e,3e3))),this.$store.commit("setIsLoading",!1))}}};const ho=(0,D.Z)(po,[["render",mo],["__scopeId","data-v-65076a6f"]]);var go=ho,_o=o(65),fo=(0,_o.MT)({state:{access:"",refresh:"",isLoading:!1},mutations:{initializeStore(e){localStorage.getItem("access")?e.access=localStorage.getItem("access"):e.access=""},setAccess(e,t){e.access=t},setIsLoading(e,t){e.isLoading=t},removeToken(e){e.access=""}},actions:{},modules:{}});const vo=[{path:"/",name:"home",component:S},{path:"/sign-up",name:"SignUp",component:ae},{path:"/log-in",name:"LogIn",component:Ce},{path:"/my-account",name:"MyAccount",component:Ve,meta:{requireLogin:!0}},{path:"/clientes",name:"Clientes",component:Et,meta:{requireLogin:!0}},{path:"/faturas",name:"Faturas",component:tt,meta:{requireLogin:!0}},{path:"/fatura/:id",name:"Fatura",component:wt,meta:{requireLogin:!0}},{path:"/cliente/:id",name:"Cliente",component:go,meta:{requireLogin:!0}}],wo=(0,L.p7)({history:(0,L.PO)("/static/"),routes:vo});wo.beforeEach(((e,t,o)=>{e.matched.some((e=>e.meta.requireLogin))&&!fo.state.access?o({name:"LogIn",query:{to:e.path}}):o()}));var bo=wo;$().defaults.baseURL=window.location.origin,"http://localhost:8080"==$().defaults.baseURL&&($().defaults.baseURL="http://127.0.0.1:8000"),(0,n.ri)(I).use(fo).use(bo,$()).mount("#app")}},t={};function o(n){var a=t[n];if(void 0!==a)return a.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,o),s.exports}o.m=e,function(){var e=[];o.O=function(t,n,a,s){if(!n){var i=1/0;for(c=0;c<e.length;c++){n=e[c][0],a=e[c][1],s=e[c][2];for(var r=!0,l=0;l<n.length;l++)(!1&s||i>=s)&&Object.keys(o.O).every((function(e){return o.O[e](n[l])}))?n.splice(l--,1):(r=!1,s<i&&(i=s));if(r){e.splice(c--,1);var u=a();void 0!==u&&(t=u)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[n,a,s]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,s,i=n[0],r=n[1],l=n[2],u=0;if(i.some((function(t){return 0!==e[t]}))){for(a in r)o.o(r,a)&&(o.m[a]=r[a]);if(l)var c=l(o)}for(t&&t(n);u<i.length;u++)s=i[u],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(c)},n=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(6691)}));n=o.O(n)})();
//# sourceMappingURL=app.cfdffd7c.js.map